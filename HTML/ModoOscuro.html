<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Modo claro/oscuro (Mejor UX)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

* {
  box-sizing: border-box;
}

:root {
  --bg: #0f172a;
  --fg: #e5e7eb;
  --card: #020617;
  --accent: #38bdf8;
}

body.light {
  --bg: #f3f4f6;
  --fg: #111827;
  --card: #ffffff;
  --accent: #2563eb;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
  background: var(--bg);
  color: var(--fg);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1.5rem;
  transition: background 0.25s ease, color 0.25s ease;
}

.card {
  background: var(--card);
  border-radius: 16px;
  padding: 1.75rem 1.5rem;
  width: 100%;
  max-width: 420px;
  box-shadow: 0 14px 35px rgba(0,0,0,0.45);
  border: 1px solid rgba(148,163,184,0.3);
}

h1 {
  margin: 0 0 0.35rem;
  font-size: 1.4rem;
}

p.subtitle {
  margin: 0 0 1rem;
  font-size: 0.9rem;
  opacity: 0.8;
}

.preview {
  margin-top: 1.2rem;
  padding: 1rem;
  border-radius: 12px;
  border: 1px dashed rgba(148,163,184,0.6);
  font-size: 0.9rem;
}

.toggle-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  margin-top: 0.75rem;
}

.mode-label {
  font-size: 0.9rem;
  opacity: 0.9;
}

/* SWITCH ACCESIBLE */
.pill {
  width: 64px;
  height: 32px;
  border-radius: 999px;
  background: rgba(148,163,184,0.4);
  display: flex;
  align-items: center;
  padding: 3px;
  cursor: pointer;
  transition: background 0.2s ease;
  border: none;
  outline: none;
}

/* Foco visible al usar TAB */
.pill:focus-visible {
  box-shadow: 0 0 0 3px rgba(56,189,248,0.6);
}

.thumb {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  background: var(--accent);
  transform: translateX(0);
  transition: transform 0.2s ease;
}

body.light .thumb {
  transform: translateX(30px);
}

.hint {
  margin-top: 0.7rem;
  font-size: 0.8rem;
  opacity: 0.8;
}

.btn {
  margin-top: 1.1rem;
  font: inherit;
  border-radius: 999px;
  padding: 0.45rem 1rem;
  border: 1px solid rgba(148,163,184,0.6);
  background: transparent;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85rem;
}
  </style>
</head>

<body>
  <section class="card">
    <h1>Modo claro / oscuro</h1>

    <p class="subtitle">
      Cambia el tema. Se guardará tu preferencia y también funciona con teclado.
    </p>

    <div class="row">
      <span class="mode-label" id="mode-label">Modo oscuro</span>

      <!-- BOTÓN ACCESIBLE -->
      <button class="pill" id="theme-toggle" aria-label="Cambiar tema">
        <div class="thumb"></div>
      </button>
    </div>

    <div class="preview">
      Este es un ejemplo de contenido que cambia de aspecto según el tema
      seleccionado por el usuario.
    </div>

    <p class="hint">
      UX aplicado: switch accesible, foco visible, preferencia del sistema, feedback y reset claro.
    </p>

    <div class="actions">
      <button class="btn" id="reset-pref" type="button">Olvidar preferencia</button>
      <button class="btn primary" id="announce" type="button">Mostrar estado</button>
    </div>

    <div class="status" id="status" role="status" aria-live="polite"></div>
  </section>

  <script>
    const themeSwitch = document.getElementById("theme-switch");
    const modeLabel = document.getElementById("mode-label");
    const resetBtn = document.getElementById("reset-pref");

    function applyTheme(theme) {
      if (theme === "light") {
        document.body.classList.add("light");
        modeLabel.textContent = "Modo claro";
      } else {
        document.body.classList.remove("light");
        modeLabel.textContent = "Modo oscuro";
      }

      modeLabel.style.opacity = "0.5";
      setTimeout(() => modeLabel.style.opacity = "1", 150);
    }

    function loadTheme() {
      const stored = localStorage.getItem("theme");

      if (stored) {
        applyTheme(stored);
      } else {
        const prefersLight = window.matchMedia("(prefers-color-scheme: light)").matches;
        applyTheme(prefersLight ? "light" : "dark");
      }
    }

    toggle.addEventListener("click", () => {
      const isLight = document.body.classList.contains("light");
      const newTheme = isLight ? "dark" : "light";
      applyTheme(newTheme);
      localStorage.setItem("theme", newTheme);
      setStatus("Preferencia guardada.");
    });

    // UX: botón reset con confirmación para evitar borrados accidentales
    resetBtn.addEventListener("click", () => {
      const ok = confirm("¿Seguro que quieres olvidar tu preferencia de tema?");
      if (!ok) return;

      localStorage.removeItem("theme");
      const fallback = systemPrefersLight() ? "light" : "dark";
      applyTheme(fallback);
      setStatus("Preferencia eliminada. Volví al tema del sistema.");
    });

    // Botón que muestra el estado (solo para demo UX)
    announceBtn.addEventListener("click", () => {
      const stored = localStorage.getItem("theme");
      setStatus(stored ? `Guardado en localStorage: ${stored}` : "No hay tema guardado.");
    });

    loadTheme();
  </script>
</body>
</html>
